{"task:12":"{\"uid\":\"12\",\"title\":\"火车票BBBB\",\"fromUrl\":\"https://kyfw.12306.cn\\nhttp://www.12306.cn/mormhweb/\\nhttps://kyfw.12306.cn/otn/confirmPassenger/initDc\",\"toUrl\":\"/***设置内容开始*****/\\nvar myUserName=\\\"<用户账号>\\\";// 输入你账号\\nvar myPassword=\\\"<用户密码>\\\";// 输入你的密码\\nvar myTime=[\\\"K279\\\",\\\"K179\\\"];//---选择车次，可以多选\\nvar myFrom=\\\"北京\\\";//---从哪里出发\\nvar myTo=\\\"郑州\\\"; //-- 到哪里\\nvar wantDate=\\\"2018-09-14\\\";// start arrive date\\nvar users=[\\\"<用户名字>\\\"];//选择购买的人名字\\n\\nvar xibie=[\\\"硬座\\\"];//,\\\"软卧\\\",\\\"硬卧\\\"//--选择席别，可以多选\\nvar mapXiBie={\\\"硬座\\\":\\\"yz_num\\\",\\\"硬卧\\\":\\\"yw_num\\\",\\\"软座\\\":\\\"rz_num\\\",\\\"软卧\\\":\\\"rw_num\\\"};\\nvar isAutoSumbitFire=false;//---自动提交订单\\n/***设置内容结束*******/\\nvar autoTime=5000;\\nvar messageAlertInterval=6;//---QQ msg 间隔\\nvar messageAlertOutInterval=18;//--登陆提醒\\nvar messageAlertLast=Date.parse(new Date());\\nvar yj=false;\\nvar yjT=2;\\nvar yjS=1;\\nvar thisTime=new Date();\\nvar myOnceGet=true;\\nvar currentUrl=location.href;\\nvar currentXibie=\\\"\\\";\\n\\nvar timeList;\\n\\nvar tacketInfoMap={train_no:2,\\nsecretStr:0,\\nstation_train_code:3,\\nstart_station_telecode:4,\\nbuttonTextInfo:1,\\nend_station_telecode:5,\\nfrom_station_telecode:6,\\nto_station_telecode:7,\\nstart_time:8,\\narrive_time:9,\\nlishi:10,\\nyp_info:12,\\nstart_train_date:13,\\ntrain_seat_feature:14,\\nlocation_code:15,\\nfrom_station_no:16,\\nto_station_no:17,\\nis_support_card:18,\\ncanWebBuy:11,\\ngg_num:20,\\ngr_num:21,\\nqt_num:22,\\nrw_num:23,\\nrz_num:24,\\ntz_num:25,\\nwz_num:26,\\nyb_num:27,\\nyw_num:28,\\nyz_num:29,\\nze_num:30,\\nzy_num:31,\\nswz_num:32,\\nsrrb_num:33,\\ncontrolled_train_flag:19};\\nfunction loadDataList(initPageUrl){\\n\\n $.ajax({\\n  url: initPageUrl,\\n  type: 'get',\\n  dataType: 'json',\\n  timeout: 20000,\\n  success: function (data, status) {\\n\\tvar tacketsList=data.data.result;\\n\\tvar listsTacketArray=[];\\n\\tif(tacketsList){ \\n\\t\\tfor(var ti=0;ti<tacketsList.length;ti++){\\n\\t\\t\\tvar tacketInfo=tacketsList[ti].split(\\\"|\\\");\\n\\t\\t\\tvar tacketMapObj={};\\n\\t\\t\\t \\n\\t\\t\\tfor(var key in tacketInfoMap){\\n\\t\\t\\t\\ttacketMapObj[key]=tacketInfo[tacketInfoMap[key]];\\n\\t\\t\\t}\\n\\t\\t\\tlistsTacketArray[ti]=tacketMapObj;\\n\\t\\t}\\n\\t}\\n\\tvar bufferStr=\\\"\\\";\\n\\tfor(var myTi=0;myTi<myTime.length;myTi++){\\n\\t\\t\\tfor(var tli=0;tli<listsTacketArray.length;tli++){\\n\\t\\t\\t\\tif(listsTacketArray[tli].station_train_code==myTime[myTi]){\\n\\nfor(var xibieidx=0;xibieidx<xibie.length;xibieidx++){\\nvar xibieWill= xibie[xibieidx];\\nvar xibieMapCode=mapXiBie[xibieWill];\\nif(xibieMapCode){\\nvar ishaveTacket=listsTacketArray[tli][xibieMapCode];\\nif(ishaveTacket){\\nishaveTacket=ishaveTacket.replace(/\\\\s+/g,\\\"\\\")\\n}\\n\\nif(ishaveTacket==\\\"\\\"||ishaveTacket==\\\"--\\\"||ishaveTacket==\\\"无\\\"||ishaveTacket==\\\"0\\\"){\\n\\n}else if(ishaveTacket==\\\"有\\\"||isNaN(shaveTacket)==false){\\n\\n\\t\\tvar runJobGo=\\\"<script>checkG1234(\\\\\\\"\\\"+listsTacketArray[tli]['secretStr']+\\\"\\\\\\\",\\\\\\\"\\\"+listsTacketArray[tli]['start_time']+\\\"\\\\\\\",\\\\\\\"\\\"+listsTacketArray[tli]['train_no']+\\\"\\\\\\\",\\\\\\\"\\\"+listsTacketArray[tli]['from_station_telecode']+\\\"\\\\\\\",\\\\\\\"\\\"+listsTacketArray[tli]['to_station_telecode']+\\\"\\\\\\\")</script>\\\";\\n                 console.log(location.href);\\n\\t\\t$(\\\"body\\\").append($(runJobGo));\\n\\t\\t$(\\\"body\\\").append($(\\\"<input type='text' name='heheh' />\\\"));\\n\\t\\t\\n\\t\\t/**\\n\\t\\tvar script = document.createElement(\\\"script\\\");\\n\\t\\tscript.type = \\\"type/javascript\\\";\\n\\t\\tvar code = runJobGo;\\n\\t\\ttry {\\n\\t\\t\\tscript.appendChild(document.createTextNode(code));\\n\\t\\t} catch (ex) {\\n\\t\\t\\tscript.text = code;\\n\\t\\t\\tconsole.log(\\\"==============================================================\\\"+ex);\\n\\t\\t}\\n\\t\\tdocument.body.appendChild(script);\\n**/\\n\\n}\\n\\n}\\n\\n\\n}\\n\\n\\n\\n\\n\\t\\t\\t\\t\\tbufferStr+=(listsTacketArray[tli].station_train_code+\\n\\t\\t\\t\\t\\t\\\":[硬座(\\\"+listsTacketArray[tli][mapXiBie[\\\"硬座\\\"]]+\\\"),硬卧(\\\"+listsTacketArray[tli][mapXiBie[\\\"硬卧\\\"]]+\\\"),软卧(\\\"+listsTacketArray[tli][mapXiBie[\\\"软卧\\\"]]+\\\")]\\\\n\\\");\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\n\\t\\t\\t}\\n\\t\\t\\n\\t\\t\\n\\t}\\n\\tconsole.log(bufferStr);\\n\\n  },\\n  fail: function (err, status) {\\n  },error: function (response, ajaxOptions, thrownError) {\\n\\tconsole.log(\\\"retry....\\\");\\n\\tif(((Date.parse(new Date())-messageAlertLast)/1000)>messageAlertInterval){\\n\\t\\tmessageAlertLast=Date.parse(new Date());\\n\\t\\tvar json=JSON.stringify({type:\\\"qq\\\",message:\\\"网络异常\\\"});\\n\\t\\tmessageNotificationCenter(json);\\n\\t}\\n}\\n});\\n\\n\\n$.post('https://kyfw.12306.cn/otn/login/checkUser',{},\\nfunction(result){\\n\\tif(!(result.data&&result.data.flag)){\\n\\n\\t\\t$('#login_user').text('登录');\\n\\t\\tif(((Date.parse(new Date())-messageAlertLast)/1000)>messageAlertOutInterval){\\n\\t\\t\\tmessageAlertLast=Date.parse(new Date());\\n\\t\\t\\tvar json=JSON.stringify({type:\\\"qq\\\",message:\\\"用户已经下线\\\"});\\n\\t\\t\\tmessageNotificationCenter(json);\\n\\t\\t\\t//location.href=(location.href.substring(0,location.href.lastIndexOf('?'))+'?random='+Math.floor(Math.random() * 101) * (new Date().getTime()));\\n\\t\\t}\\n\\t}else{\\n\\t\\tconsole.log('online')\\n\\t}\\n}\\n);\\n  \\n\\n}\\nif(currentUrl==\\\"http://www.12306.cn/mormhweb/\\\"){\\n\\nvar btnSell=$(\\\"#indexLeftBL > ul > li:nth-child(3) > a\\\");\\nif(btnSell.size()>0){\\n\\tbtnSell.get(0).click();\\n}\\n \\n}else if(currentUrl==\\\"https://kyfw.12306.cn/otn/login/init\\\"){//---login\\n$(\\\"#username\\\").val(myUserName);\\n$(\\\"#password\\\").val(myPassword);\\n}else if(currentUrl==\\\"https://kyfw.12306.cn/otn/\\\" ||currentUrl==\\\"https://kyfw.12306.cn/otn/index/init\\\" ){//--- set arrive\\n\\nvar myFrom_data=$(\\\"#ul_list1 >li[title='\\\"+myFrom+\\\"']\\\").attr(\\\"data\\\");\\nif(myFrom_data){\\n$(\\\"#fromStation\\\").val(myFrom_data);\\n}\\nvar myTo_data=$(\\\"#ul_list1 >li[title='\\\"+myTo+\\\"']\\\").attr(\\\"data\\\");\\nif(myTo_data){\\n$(\\\"#toStation\\\").val(myTo_data);\\n}\\n$(\\\"#fromStationText\\\").val(myFrom);\\n$(\\\"#toStationText\\\").val(myTo);\\n$(\\\"#train_date\\\").val(wantDate);\\ndocument.getElementById(\\\"a_search_ticket\\\").click();\\n\\n}else if (currentUrl.indexOf(\\\"https://kyfw.12306.cn/otn/leftTicket/init\\\")>-1){//---book tackits\\n\\t \\n\\nvar initPageUrl=\\\"https://kyfw.12306.cn/otn/leftTicket/query?leftTicketDTO.train_date=\\\"+wantDate+\\\"&leftTicketDTO.from_station=\\\"+$(\\\"#fromStation\\\").val()+\\\"&leftTicketDTO.to_station=\\\"+$(\\\"#toStation\\\").val()+\\\"&purpose_codes=ADULT\\\";\\n\\n\\n/****/\\n\\nvar once=0;\\nvar myCheck=0;\\n\\nvar reload=0;\\n\\ttimeList= setInterval(function () {\\n\\t\\treload++;\\n\\t\\tvar xxxx=document.getElementById(\\\"query_ticket\\\");\\n\\t\\t\\n\\t\\t loadDataList(initPageUrl);\\n\\t\\t\\t\\n\\t\\tif(reload>20){\\n\\t\\t\\tif(xxxx){\\n                       \\n\\t\\t\\t//xxxx.click(); \\n\\t\\t        } \\n\\t\\t\\treload=0;\\n\\t\\t}\\n\\t\\t\\n\\t\\tvar arr=document.getElementsByClassName(\\\"dhtmlx_window_active\\\");\\n\\t \\n\\t//---登录验证\\nif(arr.length>0&&once==0){\\n\\t//----自动提票 \\n\\t//clearInterval(time);\\n\\tdocument.getElementById(\\\"username\\\").value=myUserName;\\n\\tdocument.getElementById(\\\"password\\\").value=myPassword;\\n\\tonce++;\\n}else{\\n\\t\\n\\n\\t\\t\\n\\t\\tvar cRun=true;\\n\\t\\t for(var i=0;i<myTime.length;i++){\\n\\t\\t\\t \\n\\t\\tvar want=$(\\\"tr[datatran$='\\\"+myTime[i]+\\\"']\\\").prev();\\n\\t\\t\\n\\t\\tif(want&&want.length>0){ \\n\\t\\t\\tvar allLet=new Array();\\n\\t\\t\\t var xIndex=new Array();\\n\\t\\t\\t var fond=false;\\n\\t\\t\\t$(\\\"#float\\\").find(\\\"th\\\").each(function(index){\\n\\t\\t\\t\\tif(index<=3&&index>0){\\n\\t\\t\\t\\t\\treturn true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tvar indexss=index-3;\\n\\t\\t\\t\\tvar xb=$(this).text();\\n\\t\\t\\t\\t \\n\\t\\t\\t\\tfor(var x=0;x<xibie.length;x++){\\n\\t\\t\\t\\t\\tif(xb==xibie[x]){\\n\\t\\t\\t\\t\\t\\txIndex.push(indexss); \\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t} \\n\\t\\t\\t\\tallLet.push(xb); \\n \\t\\t\\t});\\n\\t\\t\\t\\n\\t\\t\\t$(want).find(\\\"td\\\").each(function(index){\\n\\t\\t\\t\\t//if(index<3){\\n\\t\\t\\t\\t//\\treturn true;\\n\\t\\t\\t\\t//}\\n\\t\\t\\t\\t//var absIndex=index+3;\\n\\t\\t\\t var values=$(this).text();\\n\\t\\t\\t\\n\\t\\t\\t if(values==\\\"--\\\"||values==\\\"无\\\"){ \\n\\t\\t\\t\\t \\n\\t\\t\\t }else{\\n\\t\\t\\t\\t   //----get fond tackit\\n\\t\\t\\t\\t for(var x=0;x<xIndex.length;x++){\\n\\t\\t\\t\\t\\tif(xIndex[x]==index){\\n\\t                                \\n\\t\\t\\t\\t\\t\\tfond=true;\\n\\t\\t\\t\\t\\t\\treturn false;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\t \\n\\t\\t\\t\\t \\n\\t\\t\\t }\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t});\\n\\t\\t\\t\\n\\t\\t\\t if(yj&&fond){\\n\\t\\t\\t\\t var currentTime=new Date();\\n\\t\\t\\t\\t var dif=(currentTime.getTime()-thisTime.getTime())/1000;\\n\\t\\t\\t\\t if(dif>=30||(myOnceGet)){//yjS>yjT&&\\n\\t\\t\\t\\t\\tthisTime=currentTime;\\n\\t\\t\\t\\t\\t myOnceGet=false;\\n\\t\\t\\t\\t\\t $.ajax({url:\\\"/otn/confirmPassenger/initDc\\\",async:true});\\n\\t\\t\\t\\t }else{\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t }\\n\\t\\t\\t\\t\\n\\t\\t\\t }\\n\\t\\t\\tif(!yj){\\n\\t\\t\\t//---是否包含预定按钮,并且包含预定条件\\n\\t\\t\\t$(want).find(\\\"a\\\").each(function(){\\n\\t\\t\\t\\tvar text=$(this).text();\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t if(text.indexOf(\\\"预订\\\")>-1&&fond&&myCheck==0){\\n\\t\\t\\t\\t\\t myCheck++;\\n\\t\\t\\t\\t\\tthis.click(); \\n\\t\\t\\t\\t\\tcRun=false;\\n\\t\\t\\t\\t\\treturn false;\\n\\t\\t\\t\\t }\\n\\t\\t\\t\\t \\n\\t\\t\\t});  \\n\\t\\t\\t\\t\\n\\t\\t\\n\\t\\t}\\n\\t\\tif(!cRun){\\n\\t\\t\\tbreak;\\n\\t\\t}\\n\\t\\t\\t \\n\\t\\t } \\n\\t\\t\\n\\t}\\n\\t \\n\\t\\n} \\nif(once>5){\\n\\tonce=0;\\n}\\n\\n}, autoTime);\\n\\t\\n\\n}else if(currentUrl.indexOf(\\\"https://kyfw.12306.cn/otn/confirmPassenger/initDc\\\")>-1){\\nvar mans=0;\\n\\t//var xx=document.getElementById(\\\"normalPassenger_9\\\");\\n\\n\\t\\t var userIDs=[];\\n\\nvar intervalID = window.setInterval(checkUserBack, 200);\\n\\t\\t function checkUserBack(){\\n\\t\\t\\t if($(\\\"#normal_passenger_id\\\").find(\\\"label\\\").length==0){\\n\\t\\t\\t\\t return;\\n\\t\\t\\t }else{\\n\\t\\t\\t\\t clearInterval(intervalID);\\n\\t\\t\\t }\\n\\t\\t\\t  $(\\\"#normal_passenger_id\\\").find(\\\"label\\\").each(function(){\\n\\t\\t\\tvar userName=$(this).text();\\n\\t\\t\\tfor(var i=0;i<users.length;i++){\\n\\t\\t\\t\\tif(userName==users[i]){\\n\\t\\t\\t\\t\\tvar userId=$(this).attr(\\\"for\\\");\\n\\t\\t\\t\\t\\tuserIDs.push(userId);\\n\\t\\t\\t\\t} \\n\\t\\t\\t\\t\\n\\t\\t\\t} \\n\\t\\t\\t \\n\\t\\t\\t\\t});\\n\\t\\t \\n\\t\\t//----设置用户点击\\n　　　　if(userIDs.length>0){\\n\\t\\t\\tfor(var i=0;i<userIDs.length;i++){\\n\\t\\t\\t\\tdocument.getElementById(userIDs[i]).click(); \\n\\t\\t\\t\\t\\tvar findXb=false;\\n\\t\\t\\t\\t\\t//席别抉择\\n\\t\\t\\t\\t\\tfor(var p=0;p<xibie.length;p++){\\n\\n\\t\\t\\t\\t\\t \\n\\t\\t\\t\\t\\t\\t\\t$(\\\"#seatType_\\\"+(i+1)+\\\" option\\\").each(function(){\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tif($(this).text().indexOf(xibie[p])>-1){\\n\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t $(this).attr('selected', true);\\ncurrentXibie=xibie[p];\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tfindXb=true;\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t\\treturn false;\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t});\\n\\n\\n\\t\\t\\t\\t\\t\\t\\tif(findXb){\\n\\t\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t\\t}\\n\\n\\t\\t\\t}\\n\\t\\t}\\n\\n$(\\\"#submitOrder_id\\\").get(0).click();\\n\\n\\tvar timerSSs=window.setInterval(function(){\\n\\t\\t\\n\\tif(!$(\\\".dhtmlx_window_active\\\").is(\\\":hidden\\\")){\\n\\t\\tvar infoCrrr=$(\\\"#sy_ticket_num_id\\\").text();\\n\\t\\t//var reg = currentXibie+\\\"余票(\\\\d{1,})张\\\";\\n                    eval(\\\"var reg =/\\\"+currentXibie+\\\"余票(\\\\\\\\d{1,})张/g\\\");\\n//console.log(\\\"var reg =/\\\"+currentXibie+\\\"余票(\\\\\\\\d{1,})张/g\\\"+\\\";==================================??\\\");\\n\\t\\tvar currentResult=0;\\n\\t\\tif ((result = reg.exec(infoCrrr)) != null) {\\n\\t\\t\\t//console.log(result);\\n\\t\\t\\t\\tif(result[1]>0){\\n\\t\\t\\t\\t\\tif(isAutoSumbitFire){\\n\\t\\t\\t\\t\\t\\t$(\\\"#qr_submit_id\\\").text(result[1]+\\\"张,等待预定\\\");\\n\\n\\t\\t\\t\\t\\t\\tvar doSubmitTacket=window.setInterval(function(){\\n\\t\\t\\t\\t\\t\\tif($(\\\"#qr_submit_id\\\").attr(\\\"class\\\").indexOf(\\\"btn92s\\\")>-1){\\n\\t\\t\\t\\t\\t\\tdocument.getElementById(\\\"qr_submit_id\\\").click();\\n\\t\\t\\t\\t\\t\\t\\tclearInterval(doSubmitTacket);\\n\\t\\t\\t\\t\\t\\tconsole.log(\\\"=============success submit=====================>>>\\\");\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t},200);\\n\\t\\t\\t\\t\\t\\tconsole.log(\\\"==============wait=able===================>>>\\\");\\n\\t\\t\\t\\t\\t}else{console.log(\\\"================\\\"+result[1]+\\\"张,未自动预定\\\");\\n\\t\\t\\t\\t\\t\\t$(\\\"#qr_submit_id\\\").text(result[1]+\\\"张,未自动预定\\\");\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}else{\\n\\t\\t\\t\\t\\t$(\\\"#qr_submit_id\\\").text(\\\"不可以预定\\\");\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tclearInterval(timerSSs);\\n\\t\\n\\t\\t}\\n\\t\\n\\t}\\n\\t\\t\\n\\t\\t\\n\\t}, 200);\\n\\n}\\n}\\n\\n\\n\\n\",\"active\":true,\"pattern\":false,\"include\":true,\"equal\":false,\"inject\":true,\"isdisk\":true,\"isReplace\":false,\"isAppend\":false,\"isUnshift\":false,\"ignore\":false,\"readyBefore\":false}"}